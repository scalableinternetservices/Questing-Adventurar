<h1>Quest Board</h1>

<%= will_paginate @quests if false%>
<%= search_form_for @search do |f| %>
  <div class="field">
    <!-- NEED IMPROVEMENT -->
    <%= f.label :title_or_description_cont_any, "Keywords  " %>
    <%= f.text_field :title_or_description_cont_any, size: 20 %>
  </div>
  <div class="field">
    <%= f.label :price_gteq, "Price between" %>
    <%= f.text_field :price_gteq, size: 5 %>
    <%= f.label :price_lteq, "and" %>
    <%= f.text_field :price_lteq, size: 5 %>
    <!-- <input type="hidden" name="q[adventurer_id_blank]" id="q_adventurer_id_blank" value = '1'> -->
    <!-- <input type="hidden" name="q[questgiver_id_not_eq]" id="q_questgiver_id_not_eq" value = <%= current_user.id%>> -->
  </div>
  <div class="actions"><%= f.submit "Search" %></div>
<% end %>

<div id="tag_cloud">
  <% tag_cloud Quest.tag_counts, %w[s m l] do |tag, css_class| %>
    <mark><%= link_to tag.name, tag_path(tag.name), class: css_class %></mark>
  <% end %>
</div>

<br />
<table class="table table-striped">
  <thead>
    <tr>
      <th><%= sort_link @search, :title, "Title" %></th>
      <th><%= sort_link @search, :price, "Price" %></th>
      <th><%= sort_link @search, :description, "Description" %></th>
      <th><%= sort_link @search, :post_time, "Post time" %></th>
      <th><%= sort_link @search, :expiration_time, "Expiration time" %></th>
      <th>Questgiver</th>
      <th>&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <% @quests.each do |quest| %>
      <tr>
        <td><%= quest.title %></td>
        <td><%= quest.price %></td>
        <td><%= quest.description %></td>
        <td><%= time_ago_in_words(quest.post_time) %> ago</td>
              <% if quest.expiration_time < Time.now %>
              <td> <font color = "red"> Expired <%= time_ago_in_words(quest.expiration_time) %> ago!</font> </td>
              <% else %>
              <td>in <%= time_ago_in_words(quest.expiration_time) %>
              <% end %>
              </td>
        <td><%= link_to quest.questgiver.username, quest.questgiver.profile %></td>
        <td class="text-right">
          <%= link_to quest, class: "btn btn-default" do %>
            <span class="glyphicon glyphicon-chevron-right"></span>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<br />
<%= will_paginate @collection, renderer: BootstrapPagination::Rails %>

<%= link_to 'New Quest', new_quest_path %>
